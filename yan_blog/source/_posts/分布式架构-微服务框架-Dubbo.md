---
title: 分布式架构 - 微服务框架 Dubbo
date: 2019-03-21 17:34:01
tags:
- 分布式
- 架构
- 微服务
- Dubbo
categories:
- 分布式
---

<img style="height:40px" src="http://dubbo.apache.org/img/dubbo_colorful.png" alt="Dubbo">
## Dubbo 的背景
随着互联网的发展，网站应用的规模不断扩大，常规的垂直应用架构已无法应对，分布式服务架构以及流动计算架构势在必行，急需一个治理系统确保架构有条不紊的演进。
<!-- more -->
- **单一应用架构：**当网站流量很小时，只需一个应用，将所有功能都部署在一起，以减少部署节点和成本。 此时，用于简化增删改查工作量的<span style="color:#CA0C16">数据访问框架（ORM）</span>是关键。
- **垂直应用架构：**当访问量逐渐增大，单一应用增加机器带来的加速度越来越小，将应用拆成互不相干的几个应用，以提升效率。 此时，用于加速前端页面开发的<span style="color:#CA0C16">Web框架（MVC）</span>是关键。
- **分布式服务架构：**当垂直应用越来越多，应用之间交互不可避免，将核心业务抽取出来，作为独立的服务，逐渐形成稳定的服务中心，使前端应用能更快速的响应多变的市场需求。 此时，用于提高业务复用及整合的<span style="color:#CA0C16">分布式服务框架（RPC）</span>是关键。
- **流动计算架构：**当服务越来越多，容量的评估，小服务资源的浪费等问题逐渐显现，此时需增加一个调度中心基于访问压力实时管理集群容量，提高集群利用率。 
此时，用于提高机器利用率的<span style="color:#CA0C16">资源调度和治理中心（SOA）</span>是关键。

## 什么是 Dubbo

Dubbo 是一个分布式服务框架，致力于提供高性能和透明化的 RPC 远程服务调用方案，SOA 服务治理方案。

简单的说，dubbo 就是个服务框架，如果没有分布式的需求，其实是不需要用的，只有在分布式的时候，才有 dubbo 这样的分布式服务框架的需求。

<span style="color:#CA0C16">并且本质上是个服务调用，说白了就是个远程服务调用的分布式框架（告别 Web Service 模式中的 wsdl,以服务者与消费者的方式在 dubbo 上注册）。</span>

其核心部分包含:
- **1.远程通讯: **提供对多种基于长连接的 NIO 框架抽象封装，包括多种线程模型，序列化，以及“请求-响应”模式的信息交换方式。
- **2.集群容错: **提供基于接口方法的透明远程过程调用，包括多协议支持，以及软负载均衡，失败容错，地址路由，动态配置等集群支持。
- **3.自动发现: **基于注册中心目录服务，使服务消费方能动态的查找服务提供方，使地址透明，使服务提供方可以平滑增加或减少机器。

## Dubbo能做什么

具体能做什么：

- 透明化的远程方法调用，就像调用本地方法一样调用远程方法，只需简单配置，没有任何API侵入。      
- 软负载均衡及容错机制，可在内网替代F5等硬件负载均衡器，降低成本，减少单点。
- 服务自动注册与发现，不再需要写死服务提供方地址，注册中心基于接口名查询服务提供者的IP地址，并且能够平滑添加或删除服务提供者。

总结：Dubbo 采用全 Spring 配置方式，透明化接入应用，对应用没有任何 API 侵入，只需用 Spring 加载 Dubbo 的配置即可，Dubbo 基于 Spring 的 Schema 扩展进行加载。

## Dubbo 架构

Dubbo 已进入 Apache 孵化器。[Apache Dubbo官网地址](http://dubbo.apache.org/zh-cn/index.html)

![Dubbo 架构](http://dubbo.apache.org/img/architecture.png)

节点角色说明：
- Provider: 暴露服务的服务提供方。
- Consumer: 调用远程服务的服务消费方。
- Registry: 服务注册与发现的注册中心。
- Monitor: 统计服务的调用次调和调用时间的监控中心。
- Container: 服务运行容器。

调用关系说明：
- 0.服务容器负责启动，加载，运行服务提供者。
- 1.服务提供者在启动时，向注册中心注册自己提供的服务。
- 2.服务消费者在启动时，向注册中心订阅自己所需的服务。
- 3.注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。
- 4.服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。
- 5.服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。



更多详细教程可参考[官方文档](http://dubbo.apache.org/zh-cn/docs/user/quick-start.html)

<span style="color:#CA0C16">持续更新中...</span>
<img src="/images/Come on/Come on5.gif">
